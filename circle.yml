machine:
  java:
    version: oraclejdk8
  environment:
    GIT_AUTHOR_NAME: CircleCI
    GIT_AUTHOR_EMAIL: circleci@circleci.com

deployment:
  snapshot:
    branch: /.*-SNAPSHOT/
    commands:
     - git config --global user.name $GIT_AUTHOR_NAME
     - git config --global user.email $GIT_AUTHOR_EMAIL
     - lein deploy snapshots


database:
  pre:
    - createdb -U postgres -h localhost -p 5432 kafka_test_test
    - lein with-profile test migrate

test:
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS
    - lein test-all
